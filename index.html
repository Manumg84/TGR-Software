//// Por bloques by Manumg84 ////

<!DOCTYPE html>
<html lang="es">

<!-- ============================================================ -->
<!-- INICIO DEL HEAD - Metadatos, Fuentes, Estilos e Iconografía -->
<!-- ============================================================ -->
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestión de Taller</title>

    <!-- Google Fonts - Poppins -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />

    <!-- Bootstrap Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" rel="stylesheet">

    <!-- Estilos personalizados -->
    <link rel="stylesheet" href="style.css">
</head>
<!-- ============================================================ -->
<!-- FIN DEL HEAD -->
<!-- ============================================================ -->
<body>
    <!-- ============================================================ -->
    <!-- INICIO DEL CONTENEDOR PRINCIPAL (Wrapper General)           -->
    <!-- ============================================================ -->
    <div class="d-flex" id="wrapper">

        <!-- ============================================================ -->
        <!-- INICIO DEL SIDEBAR - Menú lateral                          -->
        <!-- ============================================================ -->
        <nav id="sidebar">
            <div class="sidebar-header">
                <i class="fas fa-tools icon"></i>
                <span class="logo-name">TallerApp</span>
            </div>
            <ul class="nav-links list-unstyled">
                <li>
                    <a href="#" class="nav-link active" data-target="dashboard" data-name="Dashboard" data-icon="fas fa-tachometer-alt">
                        <i class="fas fa-tachometer-alt icon me-2"></i>
                        <span class="link-name">Dashboard</span>
                    </a>
                </li>
                <li>
                    <a href="#" class="nav-link" data-target="gestion" data-name="Gestión" data-icon="fas fa-tasks">
                        <i class="fas fa-tasks icon me-2"></i>
                        <span class="link-name">Gestión</span>
                    </a>
                </li>
            </ul>
        </nav>
        <!-- ============================================================ -->
        <!-- FIN DEL SIDEBAR                                            -->
        <!-- ============================================================ -->
        <!-- ============================================================ -->
        <!-- INICIO DEL CONTENIDO PRINCIPAL (NAVBAR + MAIN + FOOTER)    -->
        <!-- ============================================================ -->
        <div id="page-content-wrapper" class="d-flex flex-column flex-grow-1">

            <!-- ========================== TOP NAVBAR ========================== -->
            <!-- Tarjetas de métricas: clientes, trabajos, beneficios, etc. -->
            <header id="top-navbar" class="p-3 bg-white border-bottom shadow-sm d-flex align-items-center justify-content-start">
                <div class="d-flex w-100 justify-content-around align-items-center">
                    <div class="card shadow-sm border-start border-primary border-4" style="width: 15rem;">
                        <div class="card-body">
                            <h6 class="card-title text-primary">Clientes nuevos</h6>
                            <p class="card-text fs-4 fw-bold" id="clientesNuevos">0</p>
                        </div>
                    </div>
                    <div class="card shadow-sm border-start border-success border-4" style="width: 15rem;">
                        <div class="card-body">
                            <h6 class="card-title text-success">Órdenes activas</h6>
                            <p class="card-text fs-4 fw-bold" id="ordenesActivas">0</p>
                        </div>
                    </div>
                    <div class="card shadow-sm border-start border-warning border-4" style="width: 15rem;">
                        <div class="card-body">
                            <h6 class="card-title text-warning">Presupuestos este mes</h6>
                            <p class="card-text fs-4 fw-bold" id="presupuestosMes">0</p>
                        </div>
                    </div>
                    <div class="card shadow-sm border-start border-info border-4" style="width: 15rem;">
                        <div class="card-body">
                            <h6 class="card-title text-info">Ingresos estimados (€)</h6>
                            <p class="card-text fs-4 fw-bold" id="ingresosEstimados">0</p>
                        </div>
                    </div>
                </div>
            </header>
            <!-- ======================== FIN TOP NAVBAR ======================== -->

            <!-- ======================== MAIN CONTENT ========================== -->
            <!-- Incluye tabs, secciones dinámicas, actividad reciente, etc. -->
            <main id="main-content" class="flex-grow-1 p-4">
                <ul class="nav nav-tabs" id="mainTab" role="tablist">
                    <li class="nav-item" role="presentation">
                        <button class="nav-link active" id="dashboard-tab" data-bs-toggle="tab" data-bs-target="#dashboard" type="button" role="tab" aria-controls="dashboard" aria-selected="true">Dashboard</button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="gestion-tab" data-bs-toggle="tab" data-bs-target="#gestion" type="button" role="tab" aria-controls="gestion" aria-selected="false">Gestión</button>
                    </li>
                </ul>
                <div class="tab-content mt-3" id="mainTabContent">
                    <div class="tab-pane fade show active" id="dashboard" role="tabpanel" aria-labelledby="dashboard-tab">
                        <h3>Bienvenido al Panel de Control</h3>
                        <p>Aquí puedes visualizar un resumen de la actividad del taller.</p>
                        <div class="table-responsive mt-4">
                            <table class="table table-bordered table-hover">
                                <thead class="table-light">
                                    <tr>
                                        <th>ID Cliente</th>
                                        <th>Nombre</th>
                                        <th>Total Gastado (€)</th>
                                        <th>Último Trabajo</th>
                                    </tr>
                                </thead>
                                <tbody id="tablaResumenClientes">
                                    <!-- Generado dinámicamente -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div class="tab-pane fade" id="gestion" role="tabpanel" aria-labelledby="gestion-tab">
                        <h3>Gestión de Operaciones</h3>
                        <p>Sección para controlar órdenes de trabajo, clientes, presupuestos y más.</p>
                        <!-- Aquí se integrarán las tarjetas de acceso a modales -->
                        <div class="row g-4 mt-4">
                            <div class="col-md-3">
                                <button class="btn btn-outline-primary w-100" data-bs-toggle="modal" data-bs-target="#modalCliente"><i class="fas fa-user-plus me-2"></i>Nuevo Cliente</button>
                            </div>
                            <div class="col-md-3">
                                <button class="btn btn-outline-secondary w-100" data-bs-toggle="modal" data-bs-target="#modalProveedor"><i class="fas fa-truck me-2"></i>Nuevo Proveedor</button>
                            </div>
                            <div class="col-md-3">
                                <button class="btn btn-outline-success w-100" data-bs-toggle="modal" data-bs-target="#modalTrabajo"><i class="fas fa-tools me-2"></i>Nueva Orden</button>
                            </div>
                            <div class="col-md-3">
                                <button class="btn btn-outline-warning w-100" data-bs-toggle="modal" data-bs-target="#modalPresupuesto"><i class="fas fa-file-invoice-dollar me-2"></i>Presupuesto</button>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
            <!-- ====================== FIN MAIN CONTENT ======================== -->

        </div>
        <!-- ============================================================ -->
        <!-- FIN DEL CONTENIDO PRINCIPAL                                 -->
        <!-- ============================================================ -->
<!-- ============================================================ -->
<!-- INICIO DE MODALES - Ventanas emergentes de gestión           -->
<!-- ============================================================ -->

<!-- ================= MODAL: Añadir Cliente ================= -->
<div class="modal fade" id="modalCliente" tabindex="-1" aria-labelledby="modalClienteLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <form id="formCliente">
                <div class="modal-header">
                    <h5 class="modal-title" id="modalClienteLabel">Nuevo Cliente</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label class="form-label">ID Cliente (Generado automáticamente)</label>
                        <input type="text" class="form-control" id="idCliente" disabled>
                    </div>
                    <div class="mb-3">
                        <label for="nombreCliente" class="form-label">Nombre</label>
                        <input type="text" class="form-control" id="nombreCliente" required>
                    </div>
                    <div class="mb-3">
                        <label for="telefonoCliente" class="form-label">Teléfono</label>
                        <input type="tel" class="form-control" id="telefonoCliente">
                    </div>
                    <div class="mb-3">
                        <label for="emailCliente" class="form-label">Correo electrónico</label>
                        <input type="email" class="form-control" id="emailCliente">
                    </div>
                    <div class="mb-3">
                        <label for="direccionCliente" class="form-label">Dirección</label>
                        <input type="text" class="form-control" id="direccionCliente">
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Historial</label>
                        <ul id="historialCliente" class="list-group small">
                            <!-- Se llenará dinámicamente con órdenes, presupuestos y albaranes -->
                        </ul>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="submit" class="btn btn-primary">Guardar Cliente</button>
                </div>
            </form>
        </div>
    </div>
</div>
<!-- =============== FIN MODAL: Añadir Cliente =============== -->

<!-- ================= MODAL: Añadir Proveedor ================= -->
<div class="modal fade" id="modalProveedor" tabindex="-1" aria-labelledby="modalProveedorLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <form id="formProveedor">
                <div class="modal-header">
                    <h5 class="modal-title" id="modalProveedorLabel">Nuevo Proveedor</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label class="form-label">ID Proveedor (Generado automáticamente)</label>
                        <input type="text" class="form-control" id="idProveedor" disabled>
                    </div>
                    <div class="mb-3">
                        <label for="nombreProveedor" class="form-label">Nombre</label>
                        <input type="text" class="form-control" id="nombreProveedor" required>
                    </div>
                    <div class="mb-3">
                        <label for="telefonoProveedor" class="form-label">Teléfono</label>
                        <input type="tel" class="form-control" id="telefonoProveedor">
                    </div>
                    <div class="mb-3">
                        <label for="emailProveedor" class="form-label">Correo electrónico</label>
                        <input type="email" class="form-control" id="emailProveedor">
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Historial de Albaranes</label>
                        <ul id="historialAlbaranesProveedor" class="list-group small">
                            <!-- Generado dinámicamente -->
                        </ul>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="submit" class="btn btn-primary">Guardar Proveedor</button>
                </div>
            </form>
        </div>
    </div>
</div>
<!-- =============== FIN MODAL: Añadir Proveedor =============== -->
<!-- ================= MODAL: Nueva Orden de Trabajo ================= -->
<div class="modal fade" id="modalOrden" tabindex="-1" aria-labelledby="modalOrdenLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <form id="formOrden">
                <div class="modal-header">
                    <h5 class="modal-title" id="modalOrdenLabel">Nueva Orden de Trabajo</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label class="form-label">ID Orden (Auto)</label>
                            <input type="text" class="form-control" id="idOrden" disabled>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label for="clienteOrden" class="form-label">Cliente</label>
                            <select class="form-select" id="clienteOrden">
                                <option disabled selected>Seleccionar cliente</option>
                            </select>
                        </div>
                    </div>
                    <div class="mb-3">
                        <label for="descripcionOrden" class="form-label">Descripción</label>
                        <textarea class="form-control" id="descripcionOrden" rows="3" required></textarea>
                    </div>
                    <div class="mb-3">
                        <label for="fechaOrden" class="form-label">Fecha estimada</label>
                        <input type="date" class="form-control" id="fechaOrden">
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Presupuestos asociados</label>
                        <ul id="presupuestosAsociados" class="list-group small">
                            <!-- Dinámico -->
                        </ul>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Albarán generado</label>
                        <p id="albaranAsociado" class="form-control-plaintext">No creado aún</p>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn btn-primary">Guardar Orden</button>
                </div>
            </form>
        </div>
    </div>
</div>
<!-- =============== FIN MODAL: Nueva Orden de Trabajo =============== -->

<!-- ================= MODAL: Crear Presupuesto ================= -->
<div class="modal fade" id="modalPresupuesto" tabindex="-1" aria-labelledby="modalPresupuestoLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <form id="formPresupuesto">
                <div class="modal-header">
                    <h5 class="modal-title" id="modalPresupuestoLabel">Nuevo Presupuesto</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label class="form-label">ID Presupuesto (Auto)</label>
                            <input type="text" class="form-control" id="idPresupuesto" disabled>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label for="clientePresupuesto" class="form-label">Cliente</label>
                            <select class="form-select" id="clientePresupuesto">
                                <option selected disabled>Seleccionar cliente</option>
                            </select>
                        </div>
                    </div>
                    <div class="mb-3">
                        <label for="detallePresupuesto" class="form-label">Detalle</label>
                        <textarea class="form-control" id="detallePresupuesto" rows="3" required></textarea>
                    </div>
                    <div class="mb-3">
                        <label for="fechaPresupuesto" class="form-label">Fecha</label>
                        <input type="date" class="form-control" id="fechaPresupuesto">
                    </div>
                    <div class="mb-3">
                        <label for="totalPresupuesto" class="form-label">Total estimado (€)</label>
                        <input type="number" class="form-control" id="totalPresupuesto">
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn btn-primary">Guardar Presupuesto</button>
                </div>
            </form>
        </div>
    </div>
</div>
<!-- =============== FIN MODAL: Crear Presupuesto =============== -->

<!-- ================= MODAL: Gestión de Usuarios ================= -->
<div class="modal fade" id="modalUsuario" tabindex="-1" aria-labelledby="modalUsuarioLabel" aria-hidden="true">
    <div class="modal-dialog modal-md">
        <div class="modal-content">
            <form id="formUsuario">
                <div class="modal-header">
                    <h5 class="modal-title" id="modalUsuarioLabel">Gestión de Usuarios</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label for="nombreUsuario" class="form-label">Nombre de usuario</label>
                        <input type="text" class="form-control" id="nombreUsuario" required>
                    </div>
                    <div class="mb-3">
                        <label for="rolUsuario" class="form-label">Rol</label>
                        <select class="form-select" id="rolUsuario">
                            <option value="admin">Administrador</option>
                            <option value="empleado">Empleado</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label for="claveUsuario" class="form-label">Contraseña</label>
                        <input type="password" class="form-control" id="claveUsuario">
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn btn-primary">Guardar Usuario</button>
                </div>
            </form>
        </div>
    </div>
</div>
<!-- =============== FIN MODAL: Gestión de Usuarios =============== -->

<!-- ================= MODAL: Agenda y Cuadrante de Vacaciones ================= -->
<div class="modal fade" id="modalAgenda" tabindex="-1" aria-labelledby="modalAgendaLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <form id="formAgenda">
                <div class="modal-header">
                    <h5 class="modal-title" id="modalAgendaLabel">Agenda y Vacaciones</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label for="trabajadorAgenda" class="form-label">Seleccionar trabajador</label>
                        <select class="form-select" id="trabajadorAgenda">
                            <option selected disabled>Seleccionar</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label for="tipoEvento" class="form-label">Tipo de evento</label>
                        <select class="form-select" id="tipoEvento">
                            <option value="agenda">Agenda</option>
                            <option value="vacaciones">Vacaciones</option>
                        </select>
                    </div>
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="fechaInicio" class="form-label">Fecha de inicio</label>
                            <input type="date" class="form-control" id="fechaInicio">
                        </div>
                        <div class="col-md-6 mb-3">
                            <label for="fechaFin" class="form-label">Fecha de fin</label>
                            <input type="date" class="form-control" id="fechaFin">
                        </div>
                    </div>
                    <div class="mb-3">
                        <label for="descripcionEvento" class="form-label">Descripción</label>
                        <textarea class="form-control" id="descripcionEvento" rows="3"></textarea>
                    </div>

                    <div class="mt-4">
                        <h6>Calendario general</h6>
                        <div id="calendarioVacaciones" class="border p-3 rounded bg-light">
                            <!-- Calendario dinámico -->
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn btn-primary">Guardar Evento</button>
                </div>
            </form>
        </div>
    </div>
</div>
<!-- =============== FIN MODAL: Agenda y Cuadrante de Vacaciones =============== -->

<!-- ============================================================ -->
<!-- FIN DE MODALES                                               -->
<!-- ============================================================ -->
        <!-- ============================================================ -->
        <!-- INICIO DE SCRIPTS Y CIERRE DEL DOCUMENTO                     -->
        <!-- ============================================================ -->

        <!-- Bootstrap Bundle con Popper -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-ENjdO4Dr2bkBIFxQpeoZ3HUHU+F43pR4pqhTnK+62I95H59snj5q+8nbTov4+1p" crossorigin="anonymous"></script>

        <!-- FontAwesome -->
        <script src="https://kit.fontawesome.com/3d7c96eb3e.js" crossorigin="anonymous"></script>

        <!-- Chart.js para gráficas -->
        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

        <!-- Luxon para fechas -->
        <script src="https://cdn.jsdelivr.net/npm/luxon@3.3.0/build/global/luxon.min.js"></script>

        <!-- Tu script principal -->
        <script src="app.js"></script>

        <!-- ============================================================ -->
        <!-- FIN DE SCRIPTS Y CIERRE DEL DOCUMENTO                        -->
        <!-- ============================================================ -->
    </body>
</html>
